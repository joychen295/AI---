# 辰极智脑 - 文档管理需求说明书

## 一、修订记录

| 修订日期 | 修订内容 | 修订人员 | 审核人员 |
| :--- | :--- | :--- | :--- |
| 2025-12-03 | 辰极智脑文档管理功能初稿 | 陈文静 | - |

---

## 二、需求背景与目标

### 2.1 编写目的

本文档旨在明确“辰极智脑”系统中“文档管理”模块的功能需求、交互逻辑及非功能性指标。该文档将作为UI设计、前端开发、后端开发及测试用例编写的依据。

### 2.2 产品背景

在企业知识管理和AI应用场景下，非结构化数据（文档）是核心资产。需要一个统一的文档管理平台来支撑知识库的构建与维护。文档管理功能作为辰极智脑的基础能力，为后续的 RAG（检索增强生成）、AI 问答、知识检索等功能提供底层数据支撑。

### 2.3 术语定义

* **RAG (Retrieval-Augmented Generation)**: 检索增强生成，一种结合了检索和生成能力的 AI 技术。
* **OSS (Object Storage Service)**: 对象存储服务，用于存储海量非结构化数据。
* **向量化 (Embedding)**: 将文本转换为向量数据的过程，用于计算机理解语义。

---

## 三、用户角色与场景

### 3.1 用户角色

| 角色 | 职责描述 | 权限范围 |
| :--- | :--- | :--- |
| **普通用户** | 知识的使用者和贡献者 | 上传文档、查看/下载自己上传的文档、查询知识库 |
| **管理员** | 系统的维护者 | 管理所有文档（增删改查）、管理标签体系、配置分类、监控构建任务 |

### 3.2 典型场景

1. **知识库初始化**: 管理员批量上传公司历史技术文档（PDF/Word），系统自动解析并构建索引。
2. **日常维护**: 员工上传最新的项目周报或需求文档，打上“项目A”标签，便于后续检索。
3. **文档清理**: 管理员定期清理“解析失败”或“已过期”的文档，释放存储空间。

---

## 四、业务流程

```mermaid
graph LR
    A[用户上传文档] --> B{格式校验}
    B -- 不通过 --> C[提示错误]
    B -- 通过 --> D[上传至OSS]
    D --> E[创建文档记录]
    E --> F[触发异步解析任务]
    F --> G[文档分块 & 向量化]
    G --> H[写入向量数据库]
    H --> I[更新状态: 已处理]
    G -- 失败 --> J[更新状态: 失败]
```

---

## 五、功能性需求

### 5.1 文档列表

#### 原型图

（请插入原型图）

#### 业务说明

1. 用户进入文档管理页面，展示文档列表；
2. 页面顶部展示统计卡片，包含：总文档数、处理中、总存储量、今日上传；
3. 支持按文件名搜索、分类筛选、状态筛选、文件类型筛选、日期范围筛选；
4. 高级筛选支持：标签多选、文件大小范围；
5. 列表支持分页展示，每页默认50条，支持排序（按上传时间、文件大小）；
6. 支持多选文件进行批量操作（删除、分类、标签、下载）；

#### 界面字段说明

| 字段名 | 字段类型 | 字段长度 | 是否必填 | 展示及校验规则 |
| :--- | :--- | :--- | :--- | :--- |
| 文件名 | String | 255字符 | 是 | 展示原始文件名，带文件类型图标，鼠标悬停显示全名 |
| 文件大小 | Number | / | 是 | 自动格式化展示（KB/MB/GB） |
| 状态 | 枚举值 | / | 是 | 状态流转：Uploading -> Processing -> Processed / Failed；以Tag标签形式展示 |
| 分类 | String | / | 否 | 展示文档所属业务分类 |
| 标签 | String[] | / | 否 | 展示前3个标签，更多显示“...” |
| 上传时间 | DateTime | / | 是 | 格式：YYYY-MM-DD HH:mm:ss |

#### 界面操作说明

| 操作名称 | 操作说明 |
| :--- | :--- |
| 搜索 | 输入关键词，按文件名模糊搜索，回车触发 |
| 筛选 | 支持分类、状态（多选）、日期范围等组合筛选 |
| 排序 | 点击表头可按“上传时间”或“文件大小”升序/降序排列 |
| 查看 | 点击文件名或查看按钮，右侧滑出文档详情侧边栏 |
| 下载 | 点击下载当前文件 |
| 删除 | 点击弹出确认框，确认后删除文件 |
| 批量操作 | 勾选列表项后，顶部出现批量操作栏 |

---

### 5.2 文档上传

#### 原型图

（请插入原型图）

#### 业务说明

1. 点击【上传文档】按钮，弹出上传对话框；
2. 支持拖拽上传和点击上传两种方式；
3. 支持多文件同时上传（单次最多支持数量需定义，建议20个）；
4. 上传过程中实时显示每个文件的上传进度（百分比）；
5. 支持配置：文档分类选择（默认为“未分类”）、初始标签添加；
6. 上传完成后，弹窗自动关闭，右下角弹出Toast提示，并自动刷新文件列表；

#### 界面字段说明

| 字段名 | 字段类型 | 字段长度 | 是否必填 | 展示及校验规则 |
| :--- | :--- | :--- | :--- | :--- |
| 上传文件 | File | 100MB | 是 | 支持格式：pdf, txt, md, doc, docx, ppt, pptx, xls, xlsx, csv, json, xml, png, jpg |
| 分类 | 枚举值 | / | 否 | 下拉选择文档分类 |
| 标签 | String[] | / | 否 | 多选标签，支持输入创建新标签 |

#### 界面操作说明

| 操作名称 | 操作说明 |
| :--- | :--- |
| 拖拽上传 | 将文件拖拽至上传区域，自动校验格式和大小 |
| 点击上传 | 点击上传区域，弹出系统文件选择框 |
| 移除文件 | 在待上传列表中移除选中的文件 |
| 确认上传 | 开始上传选中的文件，显示进度条 |
| 取消 | 关闭上传对话框 |

---

### 5.3 文档详情

#### 原型图

（请插入原型图）

#### 业务说明

1. 点击文件名或查看按钮，右侧滑出文档详情侧边栏（Drawer）；
2. 展示文件基本信息：ID、显示名称、大小、类型、状态、MD5校验和；
3. 展示并支持编辑：分类、标签、描述；
4. 展示时间戳：创建时间、上传时间、处理时间；
5. 展示解析任务日志：如“开始解析”、“分块完成”、“向量化完成”；
6. 展示OSS信息：存储桶、对象键、ETag；

#### 界面字段说明

| 字段名 | 字段类型 | 字段长度 | 是否必填 | 展示及校验规则 |
| :--- | :--- | :--- | :--- | :--- |
| 文件ID | String | / | 是 | 只读展示，UUID |
| 显示名称 | String | 255字符 | 是 | 只读展示 |
| 文件大小 | Number | / | 是 | 格式化展示 |
| 状态 | 枚举值 | / | 是 | Tag标签展示，失败状态显示红色 |
| 分类 | 枚举值 | / | 否 | 可编辑，下拉选择，失焦自动保存 |
| 标签 | String[] | / | 否 | 可编辑，多选，失焦自动保存 |
| 描述 | String | 500字符 | 否 | 可编辑，文本框 |
| 解析日志 | List | / | 否 | 按时间倒序展示解析步骤 |

#### 界面操作说明

| 操作名称 | 操作说明 |
| :--- | :--- |
| 编辑属性 | 直接点击分类、标签、描述区域进行编辑，支持即时保存 |
| 重试解析 | 对于状态为“Failed”的文档，显示重试按钮，点击触发重新解析 |
| 下载 | 下载当前文件 |
| 关闭 | 点击遮罩或关闭按钮，收起详情侧边栏 |

---

### 5.4 批量操作

#### 原型图

（请插入原型图）

#### 业务说明

1. 选中多个文件后，点击【批量操作】按钮，弹出批量操作对话框；
2. 支持四种批量操作：批量删除、批量分类、批量标签、批量下载；
3. 批量删除为危险操作，需要二次确认，提示“删除后不可恢复，且会同步删除知识库索引”；
4. 批量标签支持三种动作：添加（追加）、移除、替换（覆盖）；
5. 批量下载自动打包为 .zip 文件；

#### 界面字段说明

| 字段名 | 字段类型 | 字段长度 | 是否必填 | 展示及校验规则 |
| :--- | :--- | :--- | :--- | :--- |
| 操作类型 | 枚举值 | / | 是 | delete/category/tags/download |
| 目标分类 | 枚举值 | / | 条件必填 | 批量分类时必填 |
| 标签动作 | 枚举值 | / | 条件必填 | add/remove/replace |
| 目标标签 | String[] | / | 条件必填 | 批量标签时必填 |

#### 界面操作说明

| 操作名称 | 操作说明 |
| :--- | :--- |
| 批量删除 | 1. 选择删除操作；2. 展示危险警告；3. 确认后执行删除 |
| 批量分类 | 1. 选择分类操作；2. 下拉选择目标分类；3. 确认后执行 |
| 批量标签 | 1. 选择标签操作；2. 选择动作；3. 选择标签；4. 确认后执行 |
| 批量下载 | 1. 选择下载操作；2. 确认后生成zip包并下载 |

---

### 5.5 标签管理

#### 原型图

（请插入原型图）

#### 业务说明

1. 点击【标签管理】按钮，弹出标签管理对话框；
2. 展示所有已有标签列表；
3. 支持创建新标签、编辑标签名称、删除标签；
4. 预设标签：重要、紧急、待审核、已审核、草稿、已发布；

#### 界面字段说明

| 字段名 | 字段类型 | 字段长度 | 是否必填 | 展示及校验规则 |
| :--- | :--- | :--- | :--- | :--- |
| 标签名称 | String | 20字符 | 是 | 不可重复，支持中文、英文、数字 |

#### 界面操作说明

| 操作名称 | 操作说明 |
| :--- | :--- |
| 新建标签 | 输入标签名称，创建新标签 |
| 编辑标签 | 点击编辑图标，修改标签名称 |
| 删除标签 | 点击删除图标，删除标签（需确认） |

---

## 六、非功能性需求

### 6.1 文件限制

| 限制项 | 限制值 |
| :--- | :--- |
| 单文件大小限制 | 100 MB |
| 单次批量操作最多 | 100个文件 |
| 文件名长度限制 | 255字节（UTF-8编码） |
| 上传超时时间 | 60秒 |

### 6.2 支持的文件格式

| 类型 | 格式 |
| :--- | :--- |
| 文档类 | pdf, txt, md, doc, docx, ppt, pptx, xls, xlsx, html, htm, csv, json, xml |
| 图片类 | png, jpg, jpeg, gif, bmp, tif, tiff, webp |

### 6.3 错误提示

| 错误场景 | 提示内容 |
| :--- | :--- |
| 文件不存在 | 文件不存在或已被删除，请刷新页面 |
| 文件过大 | 文件大小超过限制（最大100MB），请压缩后重试 |
| 不支持的文件类型 | 不支持该文件格式，请上传支持的格式 |
| 批量操作超限 | 单次批量操作最多支持100个文件 |
| 解析服务超时 | 文档解析超时，请稍后点击重试 |
| 权限不足 | 您没有权限执行此操作 |

### 6.4 性能与安全性

| 类别 | 要求描述 |
| :--- | :--- |
| **性能要求** | 列表加载时间 < 1秒（1万条数据内）；内网上传速度 < 10秒（100MB）；支持20人并发上传。 |
| **安全性要求** | 只有上传者和管理员可删除文档；后端必须校验文件魔数（Magic Number）防止恶意文件上传。 |
| **可靠性要求** | 解析任务失败后自动重试3次；大文件上传建议支持断点续传。 |
