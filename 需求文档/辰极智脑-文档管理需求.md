# 辰极智脑 文档管理需求

## 一、修订记录

| 修订日期 | 修订内容                 | 修订人员 |
| -------- | ------------------------ | -------- |
| 12.03    | 辰极智脑增加文档管理功能 | 陈文静   |

---

## 二、需求背景与目标

在企业知识管理和AI应用场景下，需要一个统一的文档管理平台来支撑知识库的构建与维护。文档管理功能作为辰极智脑的基础能力，为后续的AI问答、知识检索等功能提供数据支撑。

**用户**：通过文档管理功能，可以上传、管理、分类企业文档，并将文档处理后构建知识库，实现智能检索和问答。

---

## 三、业务流程

```
用户上传文档 → 文档存储至云端 → 触发知识库构建 → 文档智能分析处理 → 向量化存储 → 可用于智能检索
    ↓
状态流转：上传中 → 已上传 → 处理中 → 已处理（或失败）
```

**知识库构建流程**：
1. 用户上传文档后，文档状态为"已上传"
2. 系统自动触发知识库构建任务，状态变更为"处理中"
3. 后台异步执行文档智能分析、分块、向量化处理
4. 处理完成后，状态变更为"已处理"；失败则变更为"失败"
5. 系统自动轮询任务状态，直到所有任务完成

---

## 四、功能性需求

### 4.1 文档列表

#### 原型图

（请插入原型图）

#### 业务说明

**页面入口**
1. 用户在左侧导航栏点击【文档管理】菜单，进入文档管理页面
2. 页面路径：文档管理
3. 权限要求：需要用户登录认证

**页头统计卡片**
1. 页面顶部展示四个统计卡片，数据实时更新：
   - **总文档数**：展示当前租户所有文档的数量
   - **处理中**：展示状态为"处理中"的文档数量
   - **总存储量**：展示所有文档占用的存储空间，格式化为 KB/MB/GB
   - **今日上传**：展示今日（当天零点至当前时刻）上传的文档数量
2. 统计数据更新时机：
   - 页面初次加载时
   - 文件上传成功后
   - 文件删除成功后
   - 任务状态变化时

**文档列表展示**
1. 列表以表格形式展示，支持以下列：
   - **选择列**：宽度 55px
     - 表头：全选复选框
     - 表体：单选复选框
     - 支持全选当前页所有文件
     - 选中状态通过背景色高亮显示

   - **文件名列**：宽度 200px
     - 左侧展示文件类型图标：
       - 图片类型（jpg/jpeg/png/gif/bmp/webp）：显示 Picture 图标，颜色：蓝色
       - 视频类型（mp4/avi/mov/wmv/flv）：显示 VideoPlay 图标，颜色：紫色
       - 其他类型：显示 Document 图标，颜色：灰色
     - 文件名可点击，点击后打开文档详情侧边栏
     - 文件名过长时自动截断，鼠标悬停显示完整文件名（Tooltip）

   - **文件大小列**：宽度 100px，右对齐
     - 格式化规则（基于对数计算）：
       - 0 - 1024 B：显示为 "XXX B"
       - 1024 B - 1 MB：显示为 "XXX.X KB"（保留1位小数）
       - 1 MB - 1 GB：显示为 "XXX.X MB"
       - 1 GB - 1 TB：显示为 "XXX.X GB"
       - 1 TB+：显示为 "XXX.X TB"
     - 示例：1048576 字节显示为 "1.0 MB"

   - **状态列**：宽度 100px
     - 以标签形式展示，标签样式：小尺寸、圆角：
       - 上传中：蓝色标签
       - 已上传：绿色标签
       - 处理中：黄色标签
       - 已处理：绿色标签
       - 失败：红色标签
       - 已删除：灰色标签

   - **分类列**：宽度 120px
     - 有分类：展示分类名称的 Tag（颜色根据分类类型区分）
     - 无分类：展示灰色文本"未分类"

   - **上传时间列**：宽度 160px
     - 格式：YYYY/M/D HH:mm:ss（如：2025/1/20 14:30:00）
     - 按上传时间倒序排列（最新上传的在最上面）

   - **操作列**：宽度 200px，固定在右侧
     - **查看按钮**：
       - 图标：View
       - 提示文案："查看详情"
       - 点击打开文档详情侧边栏
     - **下载按钮**：
       - 图标：Download
       - 提示文案："下载文件"
       - 点击下载文件到本地
     - **删除按钮**：
       - 图标：Delete
       - 提示文案："删除文件"
       - 样式：danger（红色）
       - 点击弹出确认框：
         - 标题："确认删除"
         - 内容："确定要删除文件 [文件名] 吗？此操作不可撤销。"
         - 确认按钮："确定删除"（红色）
         - 取消按钮："取消"
       - 确认后执行删除操作

2. 列表为空时，展示空状态：
   - 空状态图标
   - 提示文案："暂无文档，请点击上传按钮上传文档"
   - 提供【上传文档】按钮快捷入口

**分页控制**
1. 列表底部展示分页器
2. 分页配置：
   - 默认每页条数：20条
   - 可选每页条数：10、20、50、100
   - 当前页码：默认第1页
   - 分页器组成部分：
     - 总条数统计："共 X 条"
     - 每页条数选择器：下拉框
     - 上一页按钮
     - 页码列表：最多显示7个页码，超出显示省略号
     - 下一页按钮
     - 页码跳转输入框："前往"输入框"页"

**筛选功能**
1. **基础筛选区**（始终可见，位于统计卡片下方）：
   - **搜索框**：
     - 占位符："搜索文档名称..."
     - 左侧图标：Search
     - 宽度：250px
     - 支持清空按钮
     - 实时搜索：输入内容即时触发筛选
     - 匹配规则：按文件名模糊搜索（不区分大小写）
     - 输入防抖：300毫秒

   - **分类筛选**:
     - 组件类型:下拉单选
     - 占位符:"选择分类"
     - 宽度:150px
     - 选项列表:
       - 技术文档
       - 设计文档
       - 需求文档
       - 测试文档
       - 用户手册
     - 支持清空选择
     - 选中后仅展示该分类的文档

   - **状态筛选**:
     - 组件类型:下拉单选
     - 占位符:"选择状态"
     - 宽度:130px
     - 选项列表:
       - 上传中
       - 已上传
       - 处理中
       - 已处理
       - 失败
     - 支持清空选择
     - 选中后仅展示该状态的文档

   - **文件类型筛选**:
     - 组件类型:下拉单选
     - 占位符:"选择文件类型"
     - 宽度:150px
     - 选项列表:
       - PDF文档
       - Word文档
       - Excel表格
       - PowerPoint
       - 图片
       - 文本文档
     - 支持清空选择

   - **日期范围筛选**:
     - 组件类型:日期范围选择器
     - 起始占位符:"开始日期"
     - 结束占位符:"结束日期"
     - 范围分隔符:"至"
     - 日期格式:YYYY-MM-DD
     - 支持手动输入或日历选择
     - 支持清空选择
     - 筛选规则:按创建时间筛选,包含起始日期和结束日期

   - **高级筛选切换按钮**：
     - 位置：基础筛选区右侧
     - 收起时文案："展开高级筛选"
     - 展开时文案："收起高级筛选"
     - 图标：ArrowDown（收起时）/ ArrowUp（展开时）
     - 点击后切换高级筛选区的显示/隐藏状态

2. **高级筛选区**（点击按钮后展开，位于基础筛选区下方）：
   - **标签筛选**：
     - 标签："标签"
     - 组件类型：下拉多选
     - 占位符："选择标签"
     - 宽度：300px
     - 选项来源：系统中所有已使用的标签
     - 支持多选：可选中多个标签
     - 支持清空所有选中标签
     - 筛选逻辑：展示包含任一选中标签的文档
     - 选中的标签以标签形式展示在输入框中

   - **文件大小范围**：
     - 标签："文件大小"
     - 组件类型：两个数字输入框
     - 布局：横向排列，中间显示"-"分隔符
     - **最小大小输入框**：
       - 占位符："最小大小(MB)"
       - 最小值：0
       - 精度：2位小数
       - 单位：MB
       - 宽度：150px
     - **最大大小输入框**：
       - 占位符："最大大小(MB)"
       - 最小值：0
       - 精度：2位小数
       - 单位：MB
       - 宽度：150px
     - 筛选规则：按文件大小筛选，包含最小值和最大值
     - 校验规则：最大值不能小于最小值

3. **筛选重置按钮**：
   - 文案："重置"
   - 位置：高级筛选区右侧
   - 图标：Refresh
   - 点击后执行重置操作：
     - 清空搜索词
     - 取消所有分类、状态、文件类型、日期范围选择
     - 清空所有选中标签
     - 清空文件大小范围输入
     - 列表恢复到初始状态（展示所有文档，按上传时间倒序）

**批量操作**
1. 选中文件后的按钮展示：
   - 选中数量展示："已选中 X 个文件"，位置：表格左上角
   - 批量操作按钮组，位置：表格右上角：
     - **批量删除按钮**：
       - 文案："批量删除"
       - 按钮类型：红色
       - 图标：Delete
       - 启用条件：至少选中一个文件
       - 点击后打开批量操作对话框，默认选中删除操作
     - **批量操作按钮**（下拉菜单）：
       - 文案："批量操作"
       - 按钮类型：default
       - 图标：More
       - 启用条件：至少选中一个文件
       - 下拉菜单项：
         - 批量分类
         - 批量标签
         - 批量下载
       - 点击后打开批量操作对话框，默认选中对应操作

2. 取消选中：
   - 点击表头全选框：取消当前页所有文件的选中状态
   - 点击行复选框：取消单个文件的选中状态
   - 切换页码：保持已选中文件的状态（跨页多选）

#### 界面字段说明

| 字段名称     | 字段类型 | 字段长度 | 是否必填 | 展示及校验规则                                                               |
| ------------ | -------- | -------- | -------- | ---------------------------------------------------------------------------- |
| 文件ID       | 字符串   | 36字符   | 是       | 系统自动生成，只读；唯一标识符                                               |
| 文件名       | 字符串   | 255字符  | 是       | 原始文件名，展示时附带文件类型图标；过长时截断显示，悬停显示完整名称        |
| 文件大小     | 数字     | /        | 是       | 以字节为单位；展示时格式化为 KB/MB/GB，保留1位小数；右对齐                  |
| 状态         | 枚举值   | /        | 是       | 上传中/已上传/处理中/已处理/失败/已删除，以标签形式展示                      |
| 分类         | 字符串   | 50字符   | 否       | 文档分类，可为空；展示为标签或"未分类"                                       |
| 标签         | 数组     | /        | 否       | 文档标签数组，可为空；展示为多个标签或"无标签"                               |
| 创建时间     | 日期时间 | /        | 是       | 创建时间，格式：YYYY/M/D HH:mm:ss；列表按此字段倒序排列                     |
| 文件类型     | 字符串   | 100字符  | 是       | 文件MIME类型，如 application/pdf；用于确定文件类型图标                       |
| 文件扩展名   | 字符串   | 20字符   | 是       | 文件扩展名，如 .pdf；用于文件类型筛选                                        |

#### 界面操作说明

| 操作名称       | 操作说明                                                                                                          |
| -------------- | ----------------------------------------------------------------------------------------------------------------- |
| 搜索           | 在搜索框输入关键词，实时按文件名模糊搜索（输入防抖300毫秒）；支持清空按钮                                        |
| 分类筛选       | 下拉选择文档分类，仅展示该分类的文档；支持清空选择                                                                |
| 状态筛选       | 下拉选择文档状态，仅展示该状态的文档；支持清空选择                                                                |
| 文件类型筛选   | 下拉选择文件类型，仅展示该类型的文档；支持清空选择                                                                |
| 日期范围筛选   | 选择起止日期，仅展示该时间范围内上传的文档（包含起止日期）；支持清空选择                                          |
| 高级筛选展开   | 点击按钮切换高级筛选区域的显示/隐藏状态；图标和文案随状态变化                                                     |
| 标签筛选       | 多选标签，仅展示包含任一选中标签的文档；支持清空所有选中                                                          |
| 大小范围筛选   | 输入最小和最大文件大小（单位MB，精度2位小数），仅展示该范围内的文档（包含边界值）                                 |
| 重置筛选       | 点击重置按钮，清空所有筛选条件，列表恢复到初始状态（展示所有文档，按上传时间倒序）                               |
| 全选           | 勾选表头复选框，选中当前页所有文件；背景色高亮显示选中状态                                                        |
| 单选           | 勾选行复选框，选中/取消选中单个文件                                                                               |
| 查看详情       | 点击文件名或查看按钮，右侧滑出文档详情侧边栏（宽度50%，从右到左展开）                                             |
| 下载文件       | 点击下载按钮，系统获取文件下载链接，触发浏览器下载                                                                |
| 删除文件       | 点击删除按钮，弹出确认框（标题："确认删除"，内容包含文件名）；确认后执行删除，成功后从列表中移除该文件           |
| 批量删除       | 选中多个文件后，点击批量删除按钮，打开批量操作对话框（默认选中删除操作）                                          |
| 批量操作       | 选中多个文件后，点击批量操作下拉按钮，选择批量分类/批量标签/批量下载，打开批量操作对话框（默认选中对应操作）      |
| 分页切换       | 点击页码、上一页、下一页按钮，或输入页码跳转，切换展示的文档列表                                                  |
| 改变每页条数   | 下拉选择每页条数（10/20/50/100），列表重新加载，页码重置为第1页                                                  |
| 查看完整文件名 | 鼠标悬停在截断的文件名上，Tooltip显示完整文件名                                                                   |

---

### 4.2 文档上传

#### 原型图

（请插入原型图）

#### 业务说明

**上传入口**
1. 点击文档列表页面右上角【上传文档】按钮，弹出上传对话框
2. 对话框标题："上传文档"
3. 对话框宽度：60%（最小宽度800px，响应式）
4. 背景遮罩：半透明黑色，点击遮罩不关闭对话框

**上传方式**
1. **拖拽上传**：
   - 上传区域高度：150px
   - 边框：2px 虚线，颜色：灰色
   - 上传图标：Upload，大小：48px，颜色：主题色
   - 主提示文案："将文件拖拽到此处"，字体大小：16px
   - 副提示文案："或点击选择文件"，字体大小：14px，颜色：灰色
   - 拖拽悬停状态：
     - 边框颜色变为主题色
     - 背景色：主题色10%透明度
     - 提示文案："松开鼠标上传文件"
   - 用户将文件拖拽到上传区域，松开鼠标即可添加文件到待上传列表
   - 支持同时拖拽多个文件

2. **点击上传**：
   - 点击上传区域任意位置，打开系统文件选择对话框
   - 支持多选文件（multiple 属性）
   - 系统对话框标题："选择文件"
   - 选择文件后自动添加到待上传列表

**文件校验**（添加到列表前执行）
1. **文件大小校验**：
   - 最大限制：100 MB
   - 超限提示：文件 [文件名] 大小超过 100MB，请压缩后重试
   - 超限文件不加入上传列表

2. **文件格式校验**：
   - 支持格式：
     - 文档类：pdf、txt、md、doc、docx、ppt、pptx、xls、xlsx、html、htm、csv、json、xml
     - 图片类：png、jpg、jpeg、gif、bmp、tif、tiff、webp
   - 格式校验方式：通过文件扩展名判断（不区分大小写）
   - 不支持格式提示：不支持 [扩展名] 格式，请上传支持的格式
   - 不支持的文件不加入上传列表

3. **文件名长度校验**：
   - 最大长度：255字节
   - 超限提示：文件名过长，请修改文件名后重试

**待上传文件列表**
1. 位置：上传区域下方
2. 列表为空时：不展示
3. 列表不为空时：
   - 列表标题："待上传文件（X个）"
   - 列表高度：最大300px，超出滚动
   - 每个文件项展示：
     - **文件图标**：根据文件类型显示对应图标，大小：24px
     - **文件信息**：
       - 文件名：完整展示，过长时换行
       - 文件大小：格式化展示（KB/MB）
     - **上传状态**：
       - 待上传：展示"待上传"灰色文本
       - 上传中：展示进度条
         - 类型：线性进度条
         - 显示百分比：内部文本显示
         - 进度颜色：蓝色（0-99%）/ 绿色（100%）
         - 高度：20px
       - 上传成功：展示绿色"上传成功"文本 + 成功图标
       - 上传失败：展示红色"上传失败"文本 + 失败图标 + 失败原因
     - **操作按钮**：
       - 待上传状态：展示【移除】按钮（图标：Close，颜色：红色）
       - 其他状态：不展示移除按钮

**上传配置面板**（可展开/收起）
1. 面板标题："上传配置"
2. 默认状态：收起
3. 点击标题栏切换展开/收起状态
4. 展开时图标：ArrowDown；收起时图标：ArrowUp
5. 配置项：
   - **文档分类**：
     - 标签："分类"，标签宽度：80px
     - 组件类型：下拉单选
     - 占位符："选择文档分类（可选）"
     - 选项列表：
       - 技术文档
       - 设计文档
       - 需求文档
       - 测试文档
       - 用户手册
     - 必填：否
     - 默认值：无
     - 支持清空选择
     - 说明：所选分类将应用到所有上传的文件

   - **标签**：
     - 标签："标签"，标签宽度：80px
     - 组件类型：下拉多选
     - 占位符："选择或创建标签（可选）"
     - 选项来源：系统预设标签 + 用户创建的标签
     - 预设标签：重要、紧急、待审核、已审核、草稿、已发布
     - 支持创建新标签：
       - 输入标签名后回车创建
       - 新标签自动添加到选项列表
       - 标签名称长度限制：20字符
       - 超长提示："标签名称不能超过20字符"
     - 必填：否
     - 说明：所选标签将应用到所有上传的文件

   - **描述**：
     - 标签："描述"，标签宽度：80px
     - 组件类型：文本域
     - 占位符："输入文档描述（可选）"
     - 行数：3行
     - 最大长度：500字符
     - 显示字数统计
     - 必填：否
     - 说明：所输入的描述将应用到所有上传的文件

**上传执行**
1. 点击【开始上传】按钮，开始上传流程
2. 按钮位置：对话框底部右侧
3. 按钮状态变化：
   - 初始状态：
     - 文案："开始上传"
     - 类型：primary（主题色）
     - 禁用条件：待上传列表为空
   - 上传中状态：
     - 文案："上传中..."
     - 类型：primary
     - 禁用：true
     - 显示loading动画
   - 上传完成状态：
     - 按钮恢复初始状态

4. 上传过程：
   - **串行上传**（逐个文件上传，避免并发导致的性能问题）：
     - 遍历待上传文件列表
     - 当前文件上传完成后，开始下一个文件
     - 单个文件上传流程：
       a. 设置文件状态为"上传中"
       b. 调用上传接口
       c. 监听上传进度
       d. 实时更新进度条百分比
       e. 上传成功：设置文件状态为"上传成功"，进度条100%，变为绿色
       f. 上传失败：设置文件状态为"上传失败"，进度条变为红色，记录失败原因

   - **进度展示**：
     - 进度条展示上传百分比
     - 进度条颜色：
       - 上传中：蓝色
       - 已完成：绿色

5. 上传完成后：
   - 统计上传结果
   - 展示总体提示：
     - 全部成功：成功上传 X 个文件
     - 部分成功：成功上传 X 个文件，Y 个文件上传失败
     - 全部失败：所有文件上传失败，请检查网络后重试
   - 延迟1.5秒后自动关闭对话框
   - 刷新文档列表，展示新上传的文件
   - 刷新统计卡片数据

**上传中断处理**
1. 上传过程中点击对话框关闭按钮或按ESC键
2. 判断是否有正在上传的文件：
   - 无正在上传的文件：直接关闭对话框
   - 有正在上传的文件：弹出二次确认框
     - 标题："确认关闭"
     - 内容："正在上传中，确定要关闭吗？未完成的上传将被取消。"
     - 确认按钮文案："确定关闭"
     - 取消按钮文案："继续上传"
     - 确认后：
       - 取消所有正在上传的请求
       - 清空待上传列表
       - 关闭对话框

**取消按钮**
1. 位置：对话框底部右侧，开始上传按钮左侧
2. 文案："取消"
3. 类型：default
4. 点击后：
   - 如果有正在上传的文件，触发上传中断处理流程
   - 如果没有正在上传的文件，直接关闭对话框

#### 界面字段说明

| 字段名   | 字段类型 | 字段长度  | 是否必填 | 展示及校验规则                                                                                                          |
| -------- | -------- | --------- | -------- | ----------------------------------------------------------------------------------------------------------------------- |
| 文件列表 | 文件数组 | 100MB/个  | 是       | 支持多文件；单文件最大100MB；支持的格式：pdf/txt/md/doc/docx/ppt/pptx/xls/xlsx/html/csv/json/xml/png/jpg/jpeg/gif/bmp/tif/tiff/webp |
| 分类     | 枚举值   | /         | 否       | 可选项：技术文档/设计文档/需求文档/测试文档/用户手册；应用到所有上传的文件                                             |
| 标签     | 数组     | 20字符/个 | 否       | 多选；支持创建新标签；每个标签长度不超过20字符；应用到所有上传的文件                                                    |
| 描述     | 字符串   | 500字符   | 否       | 可选；文本域；最大500字符；应用到所有上传的文件                                                                         |

#### 界面操作说明

| 操作名称       | 操作说明                                                                                                         |
| -------------- | ---------------------------------------------------------------------------------------------------------------- |
| 拖拽上传       | 将文件拖拽至上传区域，松开鼠标后自动校验文件（大小、格式、文件名长度），校验通过后添加到待上传列表               |
| 点击上传       | 点击上传区域，打开系统文件选择对话框；支持多选；选择后自动校验，校验通过后添加到待上传列表                       |
| 移除文件       | 点击文件列表中的【移除】按钮，从待上传列表中移除该文件（仅待上传状态可移除）                                     |
| 选择分类       | 下拉选择文档分类，选中的分类将应用到所有上传的文件；支持清空选择                                                 |
| 添加标签       | 多选已有标签或输入新标签名后回车创建（标签名长度≤20字符）；选中的标签将应用到所有上传的文件；支持清空所有选中     |
| 输入描述       | 在文本域中输入文档描述（可选，最大500字符）；输入的描述将应用到所有上传的文件                                    |
| 展开/收起配置  | 点击配置面板标题栏，展开或收起上传配置面板                                                                       |
| 开始上传       | 点击【开始上传】按钮，开始串行上传流程；按钮变为禁用状态，显示loading动画；逐个文件上传，实时显示进度           |
| 取消上传       | 上传中点击【取消】按钮或关闭按钮，弹出二次确认（"正在上传中，确定要关闭吗？"）；确认后取消剩余文件的上传，关闭对话框 |
| 关闭对话框     | 上传完成后，延迟1500ms自动关闭对话框；或点击【取消】按钮关闭；关闭后自动刷新文档列表和统计卡片                   |
| 查看上传进度   | 上传中实时查看每个文件的进度条和百分比；成功文件显示绿色"上传成功"；失败文件显示红色"上传失败"和失败原因           |

---

### 4.3 文档详情

#### 原型图

（请插入原型图）

#### 业务说明

**详情侧边栏打开方式**
1. 在文档列表中点击文件名
2. 在文档列表中点击【查看】按钮
3. 从页面右侧滑出详情侧边栏

**侧边栏配置**
1. 组件类型：抽屉
2. 标题："文档详情"
3. 展开方向：从右到左
4. 宽度（动态变化）：
   - 查看模式：50%（最小宽度600px）
   - 编辑模式：60%（最小宽度720px）
   - 切换到编辑模式时平滑过渡展开
5. 背景遮罩：半透明黑色
6. 关闭方式：
   - 点击遮罩区域
   - 点击右上角关闭按钮（图标：Close）
   - 按 ESC 键
   - 如果在编辑模式且有未保存的更改，弹出确认框

**基本信息卡片**
1. 卡片标题："基本信息"
2. 卡片样式：带阴影，圆角4px
3. 展示字段（表单布局，标签宽度100px）：
   - **文件ID**：
     - 标签："文件ID"
     - 展示格式：完整唯一标识符
     - 字体：等宽字体
     - 字体大小：12px
     - 颜色：灰色
     - 可复制：右侧展示复制按钮（图标：CopyDocument），点击复制到剪贴板，提示"复制成功"

   - **显示名称**：
     - 标签："显示名称"
     - 查看模式：纯文本展示，字体大小14px
     - 编辑模式：
       - 文本输入框
       - 最大长度：255字符
       - 显示字数统计
       - 必填
       - 为空时错误提示："显示名称不能为空"

   - **文件大小**：
     - 标签："文件大小"
     - 格式化显示（KB/MB/GB）
     - 字体颜色：深灰色
     - 只读，不可编辑

   - **文件类型**：
     - 标签："文件类型"
     - 展示 MIME 类型（如：application/pdf）
     - 标签形式展示
     - 只读，不可编辑

   - **状态**：
     - 标签："状态"
     - 标签形式展示
     - 颜色根据状态值动态变化：
       - 上传中：蓝色
       - 已上传：绿色
       - 处理中：黄色
       - 已处理：绿色
       - 失败：红色
     - 只读，不可编辑

   - **分类**：
     - 标签："分类"
     - 查看模式：
       - 有分类：标签形式展示
       - 无分类：灰色文本"未分类"
     - 编辑模式：
       - 下拉单选
       - 可选项：技术文档/设计文档/需求文档/测试文档/用户手册
       - 可清空
       - 占位符："选择分类"

   - **标签**：
     - 标签："标签"
     - 查看模式：
       - 有标签：多个标签横向排列，间距8px
       - 无标签：灰色文本"无标签"
     - 编辑模式：
       - 下拉多选
       - 支持创建新标签
       - 可清空
       - 占位符："选择或创建标签"
       - 标签名称长度限制：20字符

   - **描述**：
     - 标签："描述"
     - 查看模式：
       - 纯文本展示，字体大小14px
       - 无描述时展示灰色文本"无描述"
       - 长文本自动换行
     - 编辑模式：
       - 文本域
       - 行数：3行
       - 最大长度：500字符
       - 显示字数统计
       - 占位符:"输入文档描述"

**时间信息卡片**
1. 卡片标题:"时间信息"
2. 展示字段（表单布局，标签宽度100px）：
   - **创建时间**：
     - 标签："创建时间"
     - 格式：YYYY/M/D HH:mm:ss（如：2025/1/20 14:30:00）
     - 颜色：深灰色
     - 只读

   - **上传时间**：
     - 标签："上传时间"
     - 格式同上
     - 未上传时不显示该字段
     - 只读

   - **处理完成时间**：
     - 标签："处理完成时间"
     - 格式同上
     - 未处理完成时不显示该字段
     - 只读

**存储信息卡片**
1. 卡片标题:"存储信息"
2. 卡片样式：可折叠，默认折叠状态
3. 展示字段（表单布局，标签宽度100px）：
   - **OSS存储桶**：
     - 标签："OSS存储桶"
     - 完整展示存储桶名称
     - 等宽字体，字体大小12px
     - 颜色：灰色
     - 只读

   - **对象键**：
     - 标签："对象键"
     - 完整展示OSS对象键
     - 等宽字体，字体大小12px
     - 颜色：灰色
     - 可复制：右侧展示复制按钮
     - 只读

   - **MD5校验和**：
     - 标签:"MD5校验和"
     - 完整展示32位16进制字符串
     - 等宽字体，字体大小12px
     - 颜色：灰色
     - 可复制：右侧展示复制按钮
     - 只读

   - **SHA256校验和**：
     - 标签:"SHA256校验和"
     - 显示规则：前16字符 + "..."（如：a1b2c3d4e5f6g7h8...）
     - 鼠标悬停显示完整值（Tooltip）
     - 等宽字体，字体大小12px
     - 颜色：灰色
     - 可复制完整值：右侧展示复制按钮
     - 只读

   - **上传进度**（仅上传中时显示）：
     - 标签："上传进度"
     - 进度条形式展示
     - 显示百分比
     - 颜色：蓝色（上传中）/ 绿色（已完成）

   - **处理状态**：
     - 标签："处理状态"
     - 标签形式展示
     - 可能的值及颜色：
       - 待处理：灰色
       - 处理中：蓝色
       - 已完成：绿色
       - 失败：红色
     - 只读

**操作按钮**
1. 位置：侧边栏头部右侧，按钮组横向排列
2. **编辑/保存按钮**：
   - 查看模式：
     - 文案："编辑"
     - 图标：Edit
     - 点击后：
       - 切换到编辑模式
       - 侧边栏宽度从 50% 平滑过渡到 60%
       - 可编辑字段变为输入状态
       - 按钮文案和图标变为"保存"
   - 编辑模式：
     - 文案："保存"
     - 图标：Check
     - 点击后：
       - 校验所有必填字段：
         - 显示名称不能为空
       - 校验通过后提交更新
       - 更新成功：
         - 提示："保存成功"
         - 侧边栏宽度恢复为 50%
         - 可编辑字段恢复为只读状态
         - 按钮文案和图标恢复为"编辑"
         - 刷新文档列表中该文件的信息
       - 更新失败：
         - 提示失败原因
         - 保持编辑模式

3. **下载按钮**：
   - 文案："下载"
   - 图标：Download
   - 位置：编辑按钮左侧
   - 点击后：
     - 获取文件下载链接
     - 触发浏览器下载
     - 下载成功提示："开始下载"

4. **关闭按钮**：
   - 图标：Close
   - 类型：text
   - 位置：最右侧
   - 点击后：
     - 如果在编辑模式且有未保存的更改，弹出确认框：
       - 标题："未保存的更改"
       - 类型：warning
       - 内容："您有未保存的更改，确定要关闭吗？"
       - 确认按钮文案:"放弃更改"
       - 取消按钮文案："继续编辑"
       - 确认后关闭侧边栏
     - 如果不在编辑模式或无未保存更改，直接关闭侧边栏

**编辑模式的数据校验**
1. **显示名称**：
   - 必填校验：为空时显示错误提示"显示名称不能为空"
   - 长度校验：不超过255字符，超长时提示"显示名称不能超过255字符"
   - 实时校验：输入时即时校验

2. **描述**：
   - 长度校验：不超过500字符，超长时禁止输入，显示字数统计
   - 非必填，可为空

3. **标签名称**（创建新标签时）：
   - 长度校验：不超过20字符，超长时提示"标签名称不能超过20字符"
   - 重复校验：不能与已有标签重复，重复时提示"标签名称已存在"

#### 界面字段说明

| 字段名称     | 字段类型 | 字段长度 | 是否必填 | 展示及校验规则                                                                   |
| ------------ | -------- | -------- | -------- | -------------------------------------------------------------------------------- |
| 文件ID       | 字符串   | 36字符   | 是       | 只读；完整展示；等宽字体；可复制                                                 |
| 显示名称     | 字符串   | 255字符  | 是       | 可编辑；文本输入框；必填；不能为空；实时校验                                     |
| 文件大小     | 数字     | /        | 是       | 只读；格式化展示（KB/MB/GB）                                                     |
| 文件类型     | 字符串   | 100字符  | 是       | 只读；标签形式展示                                                               |
| 状态         | 枚举值   | /        | 是       | 只读；标签形式；颜色动态变化                                                     |
| 分类         | 字符串   | 50字符   | 否       | 可编辑；下拉单选；可清空；查看模式显示为标签或"未分类"                           |
| 标签         | 数组     | 20字符/个 | 否       | 可编辑；下拉多选；支持创建新标签；查看模式显示为多个标签或"无标签"               |
| 描述         | 字符串   | 500字符  | 否       | 可编辑；文本域；最大500字符；显示字数统计                                        |
| 创建时间     | 日期时间 | /        | 是       | 只读；格式：YYYY/M/D HH:mm:ss                                                    |
| 上传时间     | 日期时间 | /        | 否       | 只读；格式同上；未上传时不显示                                                   |
| 处理完成时间 | 日期时间 | /        | 否       | 只读；格式同上；未处理完成时不显示                                               |
| 存储桶名称   | 字符串   | 100字符  | 是       | 只读；完整展示；等宽字体                                                         |
| 对象键       | 字符串   | 500字符  | 是       | 只读；完整展示；等宽字体；可复制                                                 |
| MD5校验和    | 字符串   | 32字符   | 否       | 只读；完整展示；等宽字体；可复制                                                 |
| SHA256校验和 | 字符串   | 64字符   | 否       | 只读；显示前16位+"..."；悬停显示完整值；等宽字体；可复制完整值                   |
| 上传进度     | 数字     | 0-100    | 否       | 只读；仅上传中时显示；进度条形式                                                 |
| 处理状态     | 枚举值   | /        | 是       | 只读；标签形式；待处理/处理中/已完成/失败                                        |

#### 界面操作说明

| 操作名称     | 操作说明                                                                                                                      |
| ------------ | ----------------------------------------------------------------------------------------------------------------------------- |
| 打开详情     | 点击文件名或查看按钮，右侧滑出详情侧边栏；宽度50%；背景遮罩半透明黑色                                                        |
| 关闭详情     | 点击遮罩、关闭按钮或按ESC键；如在编辑模式且有未保存更改，弹出确认框；确认后关闭侧边栏                                        |
| 切换编辑     | 点击【编辑】按钮，进入编辑模式；侧边栏平滑展开至60%；可编辑字段变为输入状态；按钮变为"保存"                                  |
| 保存修改     | 点击【保存】按钮，实时校验必填字段；校验通过后提交更新；成功后提示"保存成功"；侧边栏恢复50%；退出编辑模式；刷新列表          |
| 修改显示名称 | 编辑模式下，在文本输入框修改名称；最大255字符；实时校验必填和长度；保存生效                                                   |
| 修改分类     | 编辑模式下，下拉选择新分类；可清空；保存生效                                                                                 |
| 修改标签     | 编辑模式下，多选标签或输入新标签名（≤20字符）后回车创建；可清空；保存生效                                                    |
| 修改描述     | 编辑模式下，在文本域输入描述；最大500字符；显示字数统计；保存生效                                                             |
| 复制字段     | 点击可复制字段右侧的复制按钮；复制完整值到剪贴板；提示"复制成功"；支持复制：文件ID、对象键、MD5、SHA256                      |
| 下载文件     | 点击【下载】按钮；系统获取下载链接；触发浏览器下载；成功提示"开始下载"                                                       |
| 查看完整值   | 鼠标悬停在截断显示的字段（如SHA256）上；Tooltip显示完整值                                                                    |
| 折叠/展开卡片 | 点击存储信息卡片标题栏；切换卡片内容的折叠/展开状态                                                                          |

---

### 4.4 批量操作

#### 原型图

（请插入原型图）

#### 业务说明

**批量操作入口**
1. 在文档列表中选中至少一个文件（勾选复选框）
2. 文档列表页面右上角出现【批量操作】按钮组：
   - 已选中文件数量提示："已选中 X 个文件"，位置：表格左上角
   - 批量删除按钮
   - 批量操作下拉按钮（包含批量分类、批量标签、批量下载）
3. 按钮启用条件：至少选中一个文件
4. 点击任一批量操作按钮，打开批量操作对话框

**批量操作对话框**
1. 标题："批量操作"
2. 宽度：600px（最小宽度500px，响应式）
3. 背景遮罩：半透明黑色，点击遮罩不关闭对话框
4. 顶部信息区：
   - 展示选中文件数量："已选中 X 个文件"
   - 如果超过100个文件，展示错误提示："单次批量操作最多支持100个文件，当前已选中 X 个"，颜色：红色
5. 操作类型选择器：
   - 标签："操作类型"
   - 组件类型：单选按钮组
   - 样式：块状按钮，图标+文字
   - 可选操作：
     - **批量删除**：图标：Delete，颜色：红色
     - **批量分类**：图标：Folder，颜色：蓝色
     - **批量标签**：图标：PriceTag，颜色：绿色
     - **批量下载**：图标：Download，颜色：紫色
   - 必选，默认值根据点击的按钮确定

**批量删除操作**
1. 选择【批量删除】后，展示危险操作警告区：
   - **警告图标**：红色感叹号，大小：48px
   - **警告标题**："危险操作"，颜色：红色，字体大小：18px，加粗
   - **警告内容**："此操作将永久删除所选文件，且无法恢复。请确认后再执行。"，颜色：深灰色
   - **文件预览区**：
     - 标题："待删除文件："
     - 列表样式：带边框，最大高度200px，超出滚动
     - 展示规则：
       - 如果文件数≤5：展示所有文件名
       - 如果文件数>5：展示前5个文件名 + "还有 X 个文件..."
     - 每个文件项：
       - 文件图标（根据类型）
       - 文件名（完整展示）
       - 文件大小（格式化展示）
   - **确认复选框**：
     - 文案："我确认要删除这些文件，且明白此操作不可撤销"
     - 样式：红色文字，大字号
     - 必须勾选才能启用【确认】按钮
     - 默认不勾选

2. 点击【确认】按钮：
   - 前置校验：
     - 确认复选框未勾选：提示"请勾选确认复选框"
     - 文件数>100：提示"单次批量操作最多支持100个文件"
   - 按钮状态：
     - 文案变为"删除中..."
     - 显示loading动画
     - 禁用状态
   - 提交批量删除请求
   - 处理进度提示：显示进度条或百分比（可选）

3. 删除结果处理：
   - **全部成功**：
     - 提示：成功删除 X 个文件
     - 关闭对话框
     - 刷新文档列表
     - 刷新统计卡片
     - 清空选中状态

   - **部分成功**：
     - 提示：成功删除 X 个文件，Y 个文件删除失败
     - 对话框展示失败文件明细：
       - 表格形式
       - 列：文件名、失败原因
       - 失败文件以红色高亮显示
     - 按钮：
       - 【重试】按钮：仅针对失败文件重新执行删除
       - 【关闭】按钮：关闭对话框
     - 刷新文档列表（移除成功删除的文件）
     - 刷新统计卡片

   - **全部失败**：
     - 提示：所有文件删除失败
     - 对话框展示详细错误信息
     - 按钮：
       - 【重试】按钮：重新执行删除
       - 【关闭】按钮：关闭对话框

**批量分类操作**
1. 选择【批量分类】后，展示分类配置区：
   - **标签**："目标分类"
   - **组件类型**：下拉单选
   - **占位符**："选择分类"
   - **选项列表**：
     - 技术文档
     - 设计文档
     - 需求文档
     - 测试文档
     - 用户手册
   - **必选**：未选择时显示错误提示"请选择目标分类"
   - **说明文本**："所选分类将应用到所有选中的文件"，颜色：灰色

2. 点击【确认】按钮：
   - 前置校验：
     - 未选择分类：提示"请选择目标分类"
     - 文件数>100：提示"单次批量操作最多支持100个文件"
   - 提交批量分类请求
   - 成功后：
     - 提示：成功为 X 个文件设置分类
     - 关闭对话框
     - 刷新文档列表
     - 清空选中状态

**批量标签操作**
1. 选择【批量标签】后，展示标签操作配置区：
   - **标签操作选择**：
     - 标签："标签操作"
     - 组件类型：下拉单选
     - 占位符："选择操作类型"
     - 选项：
       - **添加标签**：
         - 文案："添加标签"
         - 说明："将选定的标签添加到文件现有标签中（不覆盖原有标签）"
       - **移除标签**：
         - 文案："移除标签"
         - 说明："从文件现有标签中移除选定的标签（保留其他标签）"
       - **替换标签**：
         - 文案："替换标签"
         - 说明："用选定的标签完全替换文件现有的所有标签（清空原有标签）"
     - 必选：未选择时显示错误提示"请选择操作类型"

   - **目标标签选择**：
     - 标签："目标标签"
     - 组件类型：下拉多选
     - 占位符："选择标签"
     - 选项来源：系统中所有标签（预设标签 + 用户创建的标签）
     - 支持创建新标签：
       - 输入标签名后回车创建
       - 标签名称长度限制：20字符
       - 超长提示："标签名称不能超过20字符"
     - 必选：未选择时显示错误提示"请选择目标标签"

2. 点击【确认】按钮：
   - 前置校验：
     - 未选择操作类型：提示"请选择操作类型"
     - 未选择目标标签：提示"请选择目标标签"
     - 文件数>100：提示"单次批量操作最多支持100个文件"
   - 提交批量标签请求
   - 成功后提示（根据操作类型）：
     - 添加：成功为 X 个文件添加标签
     - 移除：成功为 X 个文件移除标签
     - 替换：成功为 X 个文件替换标签
   - 关闭对话框
   - 刷新文档列表
   - 清空选中状态

**批量下载操作**
1. 选择【批量下载】后，展示下载配置区：
   - **压缩格式选择**：
     - 标签："压缩格式"
     - 组件类型：单选按钮组，块状样式
     - 选项：
       - **ZIP压缩包**：
         - 图标：Folder-zip
         - 说明："适用于Windows系统，兼容性好"
       - **TAR归档**：
         - 图标：Folder
         - 说明："适用于Linux/Unix系统，保留文件权限"
     - 默认选中：ZIP压缩包

   - **文件命名规则选择**：
     - 标签："文件命名规则"
     - 组件类型：下拉单选
     - 占位符："选择命名规则"
     - 选项：
       - **保持原名**：
         - 说明："文件名保持不变"
         - 示例："file1.pdf, file2.docx"
       - **添加时间戳**：
         - 说明："文件名后添加时间戳（格式：YYYYMMDDHHmmss）"
         - 示例："file1_20250120143000.pdf, file2_20250120143001.docx"
       - **顺序编号**：
         - 说明："文件名前添加顺序编号（格式：001_、002_...）"
         - 示例："001_file1.pdf, 002_file2.docx"
     - 默认选中：保持原名

2. 点击【确认】按钮：
   - 前置校验：
     - 文件数>100：提示"单次批量操作最多支持100个文件"
   - 提交批量下载请求
   - 系统处理：
     - 获取所有选中的文件
     - 根据命名规则重命名文件
     - 打包为指定格式的压缩包
     - 压缩包命名：documents_20250120143000.zip（示例）
   - 返回下载链接
   - 触发浏览器下载
   - 成功后提示：开始下载 X 个文件
   - 关闭对话框

**单次批量操作限制**
- 最多支持：100个文件
- 超过限制时：
  - 顶部展示错误提示："单次批量操作最多支持100个文件，当前已选中 X 个"
  - 错误提示样式：红色错误提示框
  - 禁用【确认】按钮
  - 显示"请减少选中文件数量后重试"

**取消按钮**
1. 位置：对话框底部右侧，确认按钮左侧
2. 文案："取消"
3. 类型：次要按钮
4. 点击后：
   - 关闭对话框
   - 不执行任何操作
   - 保持选中状态

#### 界面字段说明

| 字段名称     | 字段类型 | 字段长度  | 是否必填 | 展示及校验规则                                                                |
| ------------ | -------- | --------- | -------- | ----------------------------------------------------------------------------- |
| 操作类型     | 枚举值   | /         | 是       | 删除/分类/标签/下载，单选按钮组                                               |
| 目标分类     | 枚举值   | /         | 条件必填 | 批量分类时必填；可选项：技术文档/设计文档/需求文档/测试文档/用户手册          |
| 标签操作     | 枚举值   | /         | 条件必填 | 批量标签时必填；可选项：添加标签/移除标签/替换标签                            |
| 目标标签     | 数组     | 20字符/个 | 条件必填 | 批量标签时必填；多选；支持创建新标签                                          |
| 压缩格式     | 枚举值   | /         | 条件必填 | 批量下载时必填；可选项：ZIP压缩包/TAR归档                                     |
| 命名规则     | 枚举值   | /         | 条件必填 | 批量下载时必填；可选项：保持原名/添加时间戳/顺序编号                          |
| 删除确认     | 布尔值   | /         | 条件必填 | 批量删除时必须勾选；确认复选框                                                |

#### 界面操作说明

| 操作名称     | 操作说明                                                                                                                                   |
| ------------ | ------------------------------------------------------------------------------------------------------------------------------------------ |
| 选择操作类型 | 单选按钮组选择操作类型（删除/分类/标签/下载）；选择后展示对应的配置区；图标和颜色区分不同操作                                             |
| 批量删除     | 1. 选择删除操作；2. 阅读危险操作警告；3. 查看待删除文件列表；4. 勾选确认复选框；5. 点击【确认】；6. 等待删除完成；7. 查看结果提示        |
| 批量分类     | 1. 选择分类操作；2. 下拉选择目标分类；3. 阅读说明文本；4. 点击【确认】；5. 等待更新完成；6. 查看成功提示                                 |
| 批量标签     | 1. 选择标签操作；2. 下拉选择操作类型（添加/移除/替换）；3. 多选目标标签或创建新标签；4. 阅读操作说明；5. 点击【确认】；6. 等待更新完成；7. 查看成功提示 |
| 批量下载     | 1. 选择下载操作；2. 单选压缩格式（ZIP压缩包/TAR归档），阅读格式说明；3. 下拉选择命名规则，查看示例；4. 点击【确认】；5. 等待打包完成；6. 浏览器开始下载 |
| 取消操作     | 点击【取消】按钮或点击遮罩（如允许），关闭批量操作对话框；不执行任何操作；保持选中状态                                                     |
| 重试失败     | 批量删除部分成功后，点击【重试】按钮；仅对失败文件列表重新执行删除操作；等待删除完成；查看结果提示                                         |
| 查看失败明细 | 批量操作部分失败后，对话框展示失败文件明细表格；表格列：文件名、失败原因；失败文件以红色高亮显示                                           |

---

### 4.5 标签管理

#### 原型图

（请插入原型图）

#### 业务说明

**标签管理入口**
1. 点击文档列表页面右上角【标签管理】按钮（图标：PriceTag）
2. 弹出标签管理对话框

**标签管理对话框**
1. 标题:"标签管理"
2. 宽度：500px（最小宽度400px，响应式）
3. 高度：最大600px，超出内容区域滚动
4. 背景遮罩：半透明黑色
5. 关闭方式：
   - 点击遮罩区域
   - 点击右上角关闭按钮
   - 按 ESC 键

**顶部操作区**
1. 布局：横向排列
2. 组件：
   - **搜索框**：
     - 占位符："搜索标签..."
     - 左侧图标：Search
     - 宽度：250px
     - 支持清空按钮
     - 实时搜索：输入内容即时筛选标签列表
     - 匹配规则：按标签名称模糊搜索（不区分大小写）
     - 输入防抖：300毫秒

   - **新建标签按钮**：
     - 文案："新建标签"
     - 图标：Plus
     - 类型：主要按钮
     - 位置：搜索框右侧
     - 点击后弹出新建标签输入框

**标签列表**
1. 布局：表格形式
2. 最大高度：400px，超出滚动
3. 空状态：
   - 搜索无结果：展示"未找到匹配的标签"
   - 无标签：展示"暂无标签，请点击新建标签按钮创建"
4. 表格列：
   - **标签名称列**：
     - 列标题："标签名称"
     - 宽度：200px
     - 内容：
       - 标签名称（文本）
       - 预设标签展示灰色"预设"标识

   - **使用次数列**：
     - 列标题："使用次数"
     - 宽度：100px
     - 对齐：居中
     - 内容：
       - 预设标签：不显示使用次数
       - 自定义标签：显示"在 X 个文件中使用"
       - 使用次数为0：显示"未使用"，颜色：灰色

   - **操作列**：
     - 列标题："操作"
     - 宽度：150px
     - 固定：右侧
     - 对齐：居中
     - 内容：
       - **编辑按钮**：
         - 图标：Edit
         - 类型：文本按钮
         - 提示："编辑标签"
         - 所有标签（包括预设标签）都可编辑
       - **删除按钮**：
         - 图标：Delete
         - 类型：文本按钮，红色
         - 提示："删除标签"
         - 预设标签不显示删除按钮
         - 自定义标签显示删除按钮

**预设标签**
1. 系统预设标签列表（不可删除，可编辑名称）：
   - 重要
   - 紧急
   - 待审核
   - 已审核
   - 草稿
   - 已发布
2. 预设标签特征：
   - 标签名称后展示灰色"预设"标识
   - 不展示使用次数
   - 仅展示【编辑】按钮，不展示【删除】按钮
3. 排序规则：预设标签始终在列表最前面

**自定义标签**
1. 用户创建的标签展示：
   - 标签名称
   - 使用次数："在 X 个文件中使用"
   - 【编辑】按钮
   - 【删除】按钮
2. 排序规则：按创建时间倒序（最新创建的在最前面）

**新建标签**
1. 点击【新建标签】按钮，弹出输入对话框：
   - 标题："新建标签"
   - 宽度：400px
   - 内容：
     - **标签名称输入框**：
       - 标签："标签名称"，标签宽度：80px
       - 组件类型：文本输入框
       - 占位符："输入标签名称"
       - 最大长度：20字符
       - 显示字数统计
       - 自动聚焦
       - 实时校验：
         - 不能为空：为空时显示错误提示"标签名称不能为空"
         - 不能重复：与现有标签（包括预设标签和自定义标签）重复时显示错误提示"标签名称已存在"
         - 长度限制：超过20字符时禁止输入
   - 底部按钮：
     - **取消按钮**：
       - 文案："取消"
       - 类型：次要按钮
       - 点击后关闭输入对话框，不创建标签
     - **创建按钮**：
       - 文案："创建"
       - 类型：主要按钮
       - 禁用条件：标签名称为空或重复
       - 点击后执行创建

2. 点击【创建】按钮：
   - 校验标签名称（前置校验）
   - 提交创建标签请求
   - 创建成功：
     - 提示：标签创建成功
     - 新标签添加到列表末尾（自定义标签区域的最前面）
     - 关闭输入对话框
     - 刷新标签列表
   - 创建失败：
     - 提示失败原因
     - 保持输入对话框打开

**编辑标签**
1. 点击标签的【编辑】按钮，弹出输入对话框：
   - 标题："编辑标签"
   - 宽度：400px
   - 内容：
     - **标签名称输入框**：
       - 标签："标签名称"，标签宽度：80px
       - 组件类型：文本输入框
       - 默认值：当前标签名称
       - 最大长度：20字符
       - 显示字数统计
       - 自动聚焦并全选文本
       - 实时校验：
         - 不能为空：为空时显示错误提示"标签名称不能为空"
         - 不能与其他标签重复：与其他标签重复时显示错误提示"标签名称已存在"
         - 长度限制：超过20字符时禁止输入
   - 底部按钮：
     - **取消按钮**：
       - 文案："取消"
       - 类型：次要按钮
       - 点击后关闭输入对话框，不保存修改
     - **保存按钮**：
       - 文案："保存"
       - 类型：主要按钮
       - 禁用条件：标签名称为空、重复或未修改
       - 点击后执行更新

2. 点击【保存】按钮：
   - 校验标签名称（前置校验）
   - 提交更新标签请求
   - 更新成功：
     - 提示：标签更新成功
     - 列表中该标签名称更新
     - 关闭输入对话框
     - 刷新标签列表
     - 刷新所有使用该标签的文档（自动更新）
   - 更新失败：
     - 提示失败原因
     - 保持输入对话框打开

**删除标签**
1. 点击标签的【删除】按钮，弹出确认框：
   - 标题："确认删除"
   - 类型：警告
   - 内容：
     - 主要文案："确定要删除标签 [标签名称] 吗？"，标签名称使用黄色加粗显示
     - 警告文案（如果标签在使用中）："此标签在 X 个文件中使用，删除后将从这些文件中移除"，使用次数使用黄色加粗显示
     - 警告文案（如果标签未使用）："此操作不可撤销"
   - 按钮：
     - **取消按钮**：
       - 文案："取消"
       - 类型：次要按钮
       - 点击后关闭确认框，不删除标签
     - **确定删除按钮**：
       - 文案："确定删除"
       - 类型：危险按钮（红色）
       - 点击后执行删除

2. 点击【确定删除】按钮：
   - 提交删除标签请求
   - 系统处理：
     - 删除标签记录
     - 从所有使用该标签的文件中移除该标签（自动同步）
   - 删除成功：
     - 提示：标签删除成功
     - 从列表中移除该标签
     - 刷新标签列表
     - 刷新文档列表（如果文档列表正在展示）
   - 删除失败：
     - 提示失败原因
     - 标签保留在列表中

**关闭按钮**
1. 位置：对话框右上角
2. 图标：Close
3. 点击后关闭标签管理对话框

#### 界面字段说明

| 字段名称 | 字段类型 | 字段长度 | 是否必填 | 展示及校验规则                                                   |
| -------- | -------- | -------- | -------- | ---------------------------------------------------------------- |
| 标签ID   | 字符串   | UUID     | 是       | 系统自动生成，不展示                                             |
| 标签名称 | 字符串   | 20字符   | 是       | 不能为空；不能重复；长度不超过20字符；实时校验                   |
| 是否预设 | 布尔值   | /        | 是       | 预设标签或自定义标签；不展示，用于判断是否可删除                 |
| 使用次数 | 数字     | /        | 否       | 展示该标签在多少个文件中使用；仅自定义标签展示；预设标签不展示   |
| 创建时间 | 日期时间 | /        | 是       | 创建时间；用于排序（自定义标签按创建时间倒序）；不展示给用户     |

#### 界面操作说明

| 操作名称     | 操作说明                                                                                                                               |
| ------------ | -------------------------------------------------------------------------------------------------------------------------------------- |
| 搜索标签     | 在搜索框输入关键词，实时按标签名称模糊搜索（输入防抖300毫秒）；支持清空按钮；无匹配结果时展示"未找到匹配的标签"                        |
| 新建标签     | 1. 点击【新建标签】按钮；2. 输入对话框弹出；3. 输入标签名称（≤20字符）；4. 实时校验（非空、不重复）；5. 点击【创建】；6. 标签添加到列表 |
| 编辑标签     | 1. 点击【编辑】按钮；2. 输入对话框弹出，默认值为当前标签名称；3. 修改标签名称；4. 实时校验；5. 点击【保存】；6. 列表中标签名称更新    |
| 删除标签     | 1. 点击【删除】按钮；2. 确认框弹出，显示标签名称和使用次数；3. 阅读警告文案；4. 点击【确定删除】；5. 标签从列表移除；6. 该标签从所有文件中移除 |
| 关闭对话框   | 点击【关闭】按钮、点击遮罩或按ESC键，关闭标签管理对话框                                                                                |
| 查看使用次数 | 自定义标签"使用次数"列展示"在 X 个文件中使用"；使用次数为0时展示"未使用"                                                               |
| 查看预设标识 | 预设标签名称后展示灰色"预设"标识；预设标签不显示使用次数和删除按钮                                                                     |

---

## 五、非功能性需求

### 5.1 文件限制

| 限制项                 | 限制值               | 说明                                                                 |
| ---------------------- | -------------------- | -------------------------------------------------------------------- |
| 单文件大小限制         | 100 MB               | 前后端双重校验；超限文件拒绝上传                                     |
| 单次请求最大文件数     | 10 个                | 单次上传请求最多支持10个文件；超限提示错误                           |
| 单次批量操作最多       | 100 个文件           | 包括批量删除、批量分类、批量标签、批量下载                           |
| 文件名长度限制         | 255 字节             | 超限时提示"文件名过长，请修改文件名后重试"                           |
| 标签名称长度限制       | 20 字符              | 创建和编辑标签时校验                                                 |
| 描述长度限制           | 500 字符             | 文档描述字段的最大长度                                               |
| 上传超时时间           | 300 秒               | 单个文件上传的最大时长；超时提示错误                                 |
| 下载链接有效期         | 3600 秒（1小时）     | 下载链接的有效时长                                                   |
| 并发上传控制           | 系统自动控制         | 系统限制同时上传的文件数，防止服务器过载                             |
| 任务状态轮询间隔       | 3 秒                 | 知识库构建任务的状态轮询频率                                         |
| 分页默认条数           | 20 条                | 文档列表默认每页展示20条                                             |
| 分页最大条数           | 100 条               | 文档列表最多每页展示100条                                            |

### 5.2 支持的文件格式

| 类型   | 格式                                                                                         | 校验方式     | 说明                             |
| ------ | -------------------------------------------------------------------------------------------- | ------------ | -------------------------------- |
| 文档类 | pdf、txt、md、doc、docx、ppt、pptx、xls、xlsx、html、htm、csv、json、xml                    | 文件扩展名   | 不区分大小写                     |
| 图片类 | png、jpg、jpeg、gif、bmp、tif、tiff、webp                                                    | 文件扩展名   | 不区分大小写                     |

**不支持的格式处理**：
- 前端上传时校验文件扩展名
- 不支持的文件不加入上传列表
- 提示："不支持 [扩展名] 格式，请上传支持的格式"

### 5.3 知识库构建配置

| 配置项                   | 默认值          | 说明                                                                 |
| ------------------------ | --------------- | -------------------------------------------------------------------- |
| 分块策略                 | 基于Token分块   | 可选：基于Token分块 / 基于段落分块                                   |
| 分块大小                 | 1200 tokens     | 单个文档块的token数量                                                |
| 分块重叠大小             | 100 tokens      | 相邻文档块之间的重叠token数量                                        |
| 批处理大小               | 5 个文件        | 单次批量处理的文件数量                                               |
| 后台异步执行             | 是              | 知识库构建在后台异步执行，不阻塞用户操作                             |
| 强制重建                 | 否              | 默认不强制重建已存在的知识库                                         |
| 分割字符                 | 无              | 可选；段落分块策略下的自定义分割字符                                 |

### 5.4 文件处理状态流转

| 状态         | 说明                     | 下一状态                     | 展示颜色 |
| ------------ | ------------------------ | ---------------------------- | -------- |
| 上传中       | 正在上传                 | 已上传 或 失败               | 蓝色     |
| 已上传       | 上传完成，待处理         | 处理中                       | 绿色     |
| 处理中       | 正在处理（知识库构建中） | 已处理 或 失败               | 黄色     |
| 已处理       | 处理完成                 | -                            | 绿色     |
| 失败         | 处理失败                 | 可重新处理回到 处理中        | 红色     |
| 已删除       | 已删除                   | -                            | 灰色     |

**状态流转触发时机**：
- 上传中 → 已上传：文件上传完成时
- 已上传 → 处理中：知识库构建任务开始时
- 处理中 → 已处理：知识库构建成功时
- 处理中 → 失败：知识库构建失败时
- 任意状态 → 已删除：文件删除时

### 5.5 文件删除规则

| 删除类型     | 删除范围                                                                 | 适用场景                         |
| ------------ | ------------------------------------------------------------------------ | -------------------------------- |
| 标准删除     | 删除文件存储 + 删除文件记录；不删除知识库数据                            | 默认删除方式，保留知识库数据     |
| 强一致删除   | 1. 读取文件元数据；2. 删除知识库文档；3. 删除文件存储；4. 删除文件记录  | 需要同步删除知识库数据时         |

**删除流程说明**：
- **标准删除流程**：
  1. 删除文件存储
  2. 删除文件记录
  3. 知识库数据保留（可能导致知识库数据孤儿）

- **强一致删除流程**：
  1. 读取文件元数据
  2. 解析知识库文档ID
  3. 删除知识库文档
  4. 删除成功后，删除文件存储
  5. 删除文件记录
  6. 如果知识库删除失败，中止整个删除操作，保留文件

**删除失败处理**：
- 知识库删除失败：中止操作，返回错误"知识库删除异常，操作已中止"，不删除文件存储和文件记录
- 文件存储删除失败：记录错误日志，继续删除文件记录（可能导致存储数据孤儿）
- 文件记录删除失败：记录错误日志，返回错误"文件删除失败"
- 批量删除时：逐个处理每个文件，独立处理成功或失败，返回成功和失败统计

### 5.6 错误提示

| 错误场景             | 提示内容                                             | 处理方式                     |
| -------------------- | ---------------------------------------------------- | ---------------------------- |
| 文件不存在           | 文件不存在或已被删除，请刷新页面                     | 提示用户并刷新列表           |
| 文件过大             | 文件大小超过限制（最大100MB），请压缩后重试          | 拒绝上传，提示限制信息       |
| 不支持的文件类型     | 不支持 [扩展名] 格式，请上传支持的格式               | 拒绝上传，提示支持的格式列表 |
| 批量操作超限         | 单次批量操作最多支持100个文件，当前已选中 X 个       | 禁用确认按钮，提示当前选中数 |
| 上传超时             | 文件上传超时，请检查网络后重试                       | 提示用户重新上传             |
| 存储服务异常         | 存储服务异常，请稍后重试或联系管理员                 | 提示用户重试或联系管理员     |
| 知识库删除失败       | 知识库删除异常，操作已中止                           | 中止删除操作，保留文件       |
| 速率限制             | 请求过于频繁，请稍后重试                             | 提示用户等待后重试           |
| 文件名过长           | 文件名过长，请修改文件名后重试                       | 拒绝上传，提示修改文件名     |
| 标签名称重复         | 标签名称已存在，请使用其他名称                       | 提示用户修改标签名称         |
| 标签名称过长         | 标签名称不能超过20字符                               | 提示用户缩短标签名称         |
| 必填字段为空         | [字段名]不能为空                                     | 提示用户填写必填字段         |
| 删除失败             | 文件删除失败，请稍后重试                             | 提示用户重试                 |
| 未登录               | 请先登录                                             | 跳转到登录页面               |
| 无权限               | 您没有权限执行此操作                                 | 提示用户并禁用操作按钮       |
| 网络错误             | 网络连接失败，请检查网络后重试                       | 提示用户检查网络             |

### 5.7 性能优化

| 优化项           | 实现方式                                                                 | 效果                             |
| ---------------- | ------------------------------------------------------------------------ | -------------------------------- |
| 分页加载         | 列表分页，默认每页20条；最大支持100条/页                                 | 减少单次加载数据量，提升渲染速度 |
| 任务轮询         | 仅在有活动任务时启动轮询；无活动任务时自动停止；轮询间隔3秒              | 减少不必要的请求，节省资源       |
| 批量操作         | 支持最多100个文件批量操作；系统逐个处理，避免一次性处理过多文件导致超时  | 防止服务器过载，提升稳定性       |
| 缓存             | 查询历史存储在本地；减少重复请求                                         | 加快页面加载速度，减少网络请求   |
| 进度反馈         | 实时显示上传进度、处理进度；用户可见性高                                 | 提升用户体验，减少等待焦虑       |
| 串行上传         | 逐个文件串行上传；避免同时处理多个大文件导致浏览器内存溢出               | 提升浏览器性能，防止崩溃         |
| 后台异步处理     | 知识库构建在后台异步执行；不阻塞用户操作                                 | 提升用户体验，允许并行操作       |
| 预签名下载       | 下载文件使用预签名链接；减轻服务器压力；有效期1小时                      | 提升下载速度，减轻服务器负载     |
| 防抖处理         | 搜索框输入、筛选条件变化使用300毫秒防抖                                  | 减少不必要的请求                 |
| 懒加载           | 大列表使用虚拟滚动（可选）；图片懒加载                                   | 提升初始加载速度                 |
| 响应式设计       | 对话框、侧边栏宽度响应式；适配不同屏幕尺寸                               | 提升移动端和小屏幕设备体验       |

### 5.8 安全性

| 安全项           | 实现方式                                                                 | 说明                             |
| ---------------- | ------------------------------------------------------------------------ | -------------------------------- |
| 文件校验         | 生成文件校验和；保证文件完整性                                           | 包括MD5和SHA256校验              |
| 文件格式校验     | 前后端双重校验文件格式；拒绝不支持的格式                                 | 防止恶意文件上传                 |
| 文件大小校验     | 前后端双重校验文件大小；拒绝超限文件                                     | 防止资源耗尽攻击                 |
| 权限校验         | 所有操作需要用户认证                                                     | 保证只有登录用户可操作           |
| 防止重复上传     | 通过文件校验和判断是否为重复文件（可选功能）                             | 节省存储空间，防止重复数据       |
| 下载链接安全     | 下载链接有效期1小时；过期自动失效                                        | 防止链接泄露导致的安全问题       |
| 认证密钥         | 所有请求需要携带认证密钥；系统验证                                       | 防止未授权访问                   |
| 速率限制         | 限制请求频率；防止恶意刷接口                                             | 防止拒绝服务攻击                 |
| 二次确认         | 删除等危险操作需要用户二次确认；防止误操作                               | 提升数据安全性                   |
| 加密传输         | 所有请求使用HTTPS加密传输                                                | 防止数据被窃听                   |
| 跨站脚本防护     | 用户输入内容进行转义；防止跨站脚本攻击                                   | 保护用户数据安全                 |
| 跨站请求防护     | 使用安全令牌；防止跨站请求伪造攻击                                       | 保护用户操作安全                 |

---

## 六、补充说明

### 6.1 文件存储架构

- **存储方式**：阿里云OSS对象存储
- **存储规则**：根据文件元数据生成唯一存储路径
- **访问方式**：
  - 上传：直接上传至云端存储
  - 下载：通过预签名链接访问（有效期1小时）
  - 删除：先删除知识库（如需），再删除文件存储，最后删除文件记录
- **访问控制**：
  - 私有访问
  - 仅通过预签名链接或直接下载接口访问

### 6.2 知识库集成

- **自动构建触发时机**：文件上传成功后自动触发知识库构建
- **构建配置**：
  - 分块策略：基于Token分块
  - 分块大小：1200 tokens
  - 分块重叠：100 tokens
  - 批处理大小：5个文件/批次
- **批量处理机制**：每次处理5个文件，避免一次性处理过多文件导致超时或内存溢出
- **状态同步**：系统自动更新文件处理状态
- **查询支持**：构建完成后，文档内容可用于AI问答和知识检索
- **错误处理**：
  - 构建失败时，文件状态变为"失败"
  - 记录失败原因，用户可查看详情
  - 支持重新触发构建（手动或自动重试）

### 6.3 任务管理

- **任务类型**：知识库构建任务
- **任务状态**：
  - 待处理：任务已创建，等待执行
  - 执行中：任务正在执行
  - 已完成：任务执行成功
  - 失败：任务执行失败
- **状态轮询**：
  - 轮询间隔：3秒
  - 轮询条件：存在活动任务（待处理或执行中）
  - 停止条件：无活动任务时自动停止轮询
- **任务监控**：
  - 用户可在界面上实时查看任务进度
  - 任务完成后自动刷新文档列表和统计卡片
  - 任务失败后展示失败原因
- **任务队列**：
  - 系统使用任务队列管理任务执行
  - 支持并发执行多个任务（受批处理大小限制）
  - 任务优先级：先进先出

---

**备注**：
1. 原型图需要补充，建议使用Figma或Axure制作高保真原型
2. 文档中的所有文案、提示内容、错误信息均为实际使用的文案
3. 所有配置项、限制值、时间参数均来自实际配置
4. 如有业务调整需求，需同步更新本需求文档
5. 本文档版本：v1.0，最后更新时间：2025-12-03
