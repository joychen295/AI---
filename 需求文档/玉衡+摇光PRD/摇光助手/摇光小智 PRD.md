## 1. 产品背景与目标

### 1.1 背景说明

在 MBSE / 系统工程需求阶段，需求分析与评估工作普遍存在以下问题：

* 需求数量大、关系复杂，人工分析成本高
* 需求质量问题（歧义、冲突、不可验证、独立需求）依赖专家经验，难以规模化
* 需求评估过程缺乏一致性，不同工程师结论差异较大
* 需求问题发现滞后，往往在设计或验证阶段才暴露风险

同时，现有工具更多关注**需求的存储与管理**，而非**需求本身的质量与逻辑合理性**。

---

### 1.2 产品目标

引入 AI 对话助手「摇光小智」，作为**需求阶段的智能分析与评估助手**，目标包括：

* 降低需求分析与评估的认知成本
* 提前暴露需求风险，减少后续工程返工
* 提供可解释、可追溯的分析结论
* 支持工程师以自然语言方式与需求模型交互

---

### 1.3 核心价值定位

> 摇光小智不是替代工程师，而是**放大工程师的分析能力**

* 对初级工程师：提供结构化分析视角
* 对资深工程师：提升效率、减少遗漏
* 对团队：形成统一的需求质量分析标准

---

## 2. AI 助手角色定义

### 2.1 角色定位

**摇光小智是一个面向系统工程需求阶段的 AI 分析与评估助手**，主要用于：

* 辅助识别需求质量问题
* 分析需求之间的逻辑关系与影响范围
* 对需求变更的潜在风险进行提示
* 提供需求修改与澄清的参考建议

---

### 2.2 能力边界（能做什么）

摇光小智能够：

* 基于已有需求模型与元数据进行分析
* 识别常见需求问题类型（歧义、冲突、不可验证等）
* 给出问题理由、影响范围与风险等级
* 通过自然语言与结构化结果同时输出分析结论

---

### 2.3 能力限制（不能做什么）

摇光小智不能：

* 替代人工做最终需求裁决
* 在信息不足时给出确定性结论
* 自动生成即可直接作为最终需求的内容
* 作为合规、质量审核的唯一依据

> 系统需在界面及输出中明确提示：“AI 分析结果仅供参考”

---

### 2.4 人在回路原则（Human-in-the-loop）

* 所有高风险需求问题需人工确认
* AI 的修改建议默认不自动写回模型
* 工程师可选择采纳、修改或忽略 AI 建议

---

## 3. 核心认知能力：需求分析与评估

### 3.1 功能目标

当用户针对已有需求提出分析或评估问题时，摇光小智应能够：

* 理解用户意图，识别需求质量问题类型
* 明确涉及的需求对象（需求 ID）
* 评估问题风险等级
* 给出清晰、可解释的分析结论与建议

---

### 3.2 使用场景

**场景 1：需求质量自检**
用户希望快速了解当前需求是否存在问题。

**场景 2：需求评审辅助**
辅助发现需求的潜在风险。

**场景 3：需求变更影响分析**
用户评估修改某条需求可能带来的连锁影响。

---

### 3.3 支持的用户问题类型

| 类型 | 示例问题 |
| :--- | :--- |
| **歧义检测** | “以下需求是否存在歧义？” |
| **可验证性** | “哪些需求是不可验证的？为什么？” |
| **冲突检测** | “是否存在相互冲突的需求？” |
| **重复检测** | “是否有重复或高度相似的需求？” |
| **变更影响** | “如果提高响应时间指标，会影响哪些需求？” |

---

### 3.4 AI 认知任务拆解

当用户触发「需求分析与评估」时，系统应完成以下认知任务：

1. **问题类型识别**
    自动判断用户问题属于哪一类需求问题。

2. **需求对象定位**
    识别涉及的需求 ID（单条或多条）。

3. **问题理由分析**
    给出判断依据（语言模糊、条件缺失、逻辑冲突等）。

4. **风险等级评估**
    按规则输出风险等级：高 / 中 / 低。

5. **建议生成**
    提供修改建议或澄清方向。

---

### 3.5 输出设计（强制要求）

#### 3.5.1 自然语言输出（面向用户）

AI 应以对话方式说明：

* 发现了什么问题
* 为什么认为这是问题
* 问题可能带来的风险
* 建议的下一步动作

**示例：**
> “我注意到 **SR-015** 似乎是一个**孤立需求**。主要是因为它目前未关联任何上游来源，同时也未关联具体的下游分解需求。
>
> 这种情况可能会导致**需求来源不清，后续开发和验证时也会面临无法追溯的风险**。
>
> 建议您检查该需求的完整性，为其补充上游来源或关联相应的下游设计。”

---

### 3.6 异常与不确定性处理

#### 3.6.1 信息不足场景

当需求信息不足时，AI 应：

* 明确说明无法判断的原因
* **不输出**风险等级
* 引导用户补充信息

**示例：**
> “当前需求缺少验收条件，无法判断其可验证性，建议补充验证标准。”

#### 3.6.2 高风险问题处理

* 风险等级为「高」的问题需明确提示人工确认
* **不自动生成**修改后的需求文本

---

### 3.7 交互与对话策略

* **支持多轮追问**：如进一步分析原因、影响范围。
* **允许下钻分析**：允许用户针对某一条分析结果继续深入。
* **按需展开**：AI 不应在未被询问时强制展开全部分析。

---

### 3.8 上下文与 RAG 检索策略 (Context & RAG Strategy)

为了确保分析结果符合系统工程（MBSE）专业标准及项目特定约束，系统需通过 RAG（检索增强生成）动态获取以下上下文信息，而非仅依赖大模型通用知识。

#### 3.8.1 检索策略映射表

| 触发场景 / 用户意图 | 检索源 (Context Source) | 检索内容示例 | 作业目标 (RAG 价值) |
| :--- | :--- | :--- | :--- |
| **规范性/质量检查**<br>*(e.g. "这条需求写得规范吗？")* | **需求撰写标准库**<br>*(公司内部《需求编写手册》 / INCOSE 指南)* | EARS 句法模板、禁止使用的模糊词汇表（如"快速"、"可能"）、标点符号规范。 | **校准标准**：让 AI 依据企业特定的规则（而非通用语感）来判断需求的质量。 |
| **术语含义/模糊性分析**<br>*(e.g. "这里的'T0'是指什么？")* | **项目数据字典 / 术语表**<br>*(Glossary)* | 项目专有名词定义、缩略语对照表、物理量单位定义。 | **消歧**：防止 AI 将行业术语误读为通用词汇，确保语义准确。 |
| **技术可行性/指标评估**<br>*(e.g. "响应时间<1ms 是否合理？")* | **系统总体设计文档 / 约束规范**<br>*(Design Constraints)* | 硬件架构性能极限、通信协议带宽限制、历史项目的实测基准数据。 | **验证边界**：基于物理限制或历史经验，识别出脱离实际的技术指标。 |
| **完整性/流程合规检查**<br>*(e.g. "我是不是漏了什么？")* | **需求管理过程规范 / 检查单**<br>*(Process Checklists)* | 需求属性完整性清单（如：是否关联了验收标准？是否指定了所属子系统？）。 | **流程管控**：将抽象的“完整性”具体化为公司流程强制要求的检查项。 |

#### 3.8.2 上下文注入机制

当识别到上述意图时，系统应：

1. **检索 (Retrieve)**：从向量数据库中匹配 Top-K 相关片段。
2. **增强 (Augment)**：将检索到的规则或定义作为 `System Prompt` 的一部分输入给 AI。
    * *Prompt 示例：“请基于以下【公司需求编写规范】，检查用户输入的需求...”*
3. **生成 (Generate)**：输出基于该特定上下文的分析结果，并在引用处标注来源（如：“根据《xx规范》第3.2条...”）。
